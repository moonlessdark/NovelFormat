# getNovelByShuBao12

小说异常换行处理脚本  
  
2022年7月13日  
-- 新增全局模式2  
说明：全局模式2是结合了全局模式1和单行检测模式2种方式，先简单的进行全局换行，再根据单行模式的逻辑进行二次处理。  
实测效果优于全局模式1，但此模式也拥有单行模式的缺点，那就是双引号中的所有内容将全部视为1行，哪怕其中有换行符(比如句号 “。”)也不会进行换行，可能会导致双引号中的内容过长。  

2022年7月10日  
-- 新增单行检测模式  
说明：区分旧的全局检测模式，单行检测只对每一行的文字进行检测是否正常换行，如果没有正常换行，将拼接下一行的文字内容再次检测，直到符合正确换行的逻辑。  
该方法无法全局检测整个章节中的标点符号是否正常。换行问题不是很严重的小说章节可以使用此模式


-------------------------------------------------------------------------------------------------------------------------------------   
前言：
  有些盗版网站的小说由于异常插入了换行字符，在不需要换行的地方进行了换行操作，影响阅读体验，例如：
  
      一个小时后坐在车里妈妈双手握着方向盘纤细的手指一下一下的敲击
    着她没有说话但这个压抑的气氛搞得我更紧张了。
    强忍了半天我终于憋不住了没话找话：「唉您这个车……刚洗过吧
    挺香的跟您身上的味儿一样好闻。
    」
    妈妈没有说话斜乜着我面无表情。
    我尴尬一笑低头说：「妈我错了
    我真错了。
    」
    妈妈连忙否认：「不不不你没错我错了当妈的错了错在我当初就不
    该把你生下来我就该咬咬牙把你给打了。
    」
    我嬉皮笑脸的说：「那你也可能打掉的是我哥或者我姐我就变成了我妹了。
    」
    妈妈眉头一蹙：「什么乱七八糟的。
    我问你你跟陆依依那小丫头你们俩
    躲储物室里干什么呢？」

                                       ------节选自某小说 第一章
 <br>
 如果你此时想把小说下载下来阅读，但是又受不了这个格式，那么就可以试试我的小脚本了。
 处理后的效果如下：

    一个小时后坐在车里妈妈双手握着方向盘纤细的手指一下一下的敲击着她没有说话但这个压抑的气氛搞得我更紧张了。
    强忍了半天我终于憋不住了没话找话：“唉您这个车……刚洗过吧挺香的跟您身上的味儿一样好闻。”
    妈妈没有说话斜乜着我面无表情。
    我尴尬一笑低头说：“妈我错了我真错了。”
    妈妈连忙否认：“不不不你没错我错了当妈的错了错在我当初就不该把你生下来我就该咬咬牙把你给打了。”
    我嬉皮笑脸的说：“那你也可能打掉的是我哥或者我姐我就变成了我妹了。”
    妈妈眉头一蹙：“什么乱七八糟的。我问你你跟陆依依那小丫头你们俩躲储物室里干什么呢？”
 
 处理逻辑如下： <br>
 第一步，先去除文本中所有的换行符 <br>
 第二步，在文本中所有的”。“, ”！“, ”？“后面接一个换行符 <br>
 第三步，根据双引号中的内容进行二次处理:<br>
 
      先根据换行符进行数组切割。
      
      由于通常双引号可以表达2种意思，对话 或者 对某个词语进行强调。
      
      如果是表示对话，那么我就会判断双引号的左侧有没有表示开始说话的关键词(例如：张三大声的说道：”下大雨了，没带伞啊“)，如果是这种情况，那么会在双引号后插入一个换行符(即：张三大声的说道：”下大雨了，没带伞啊“<换行符>) 
      
      如果双引号的右侧有表示开始说话的关键词(例如：”下大雨了，没带伞啊“，张三愁眉苦脸的说道。)，那么就会在双引号之前插入换行符(例如：<换行符>”下大雨了，没带伞啊“，张三愁眉苦脸的说道。)
      
      如果双引号左右两侧均有说话的关键字，或者均没有说话的关键字，那么就不插入换行符。
      
      由于个人阅读习惯，双引号内的文字不喜欢有换行符，哪怕里面有可以识别为换行的句号。由于作者写作习惯的不同，可能会一次性说一大串的对话，不换行的话在手机上阅读起来，所有的文字都挤在一起。这个可以根据个人习惯进行源码修改。 

该逻辑无法满足所有的处理需求，我只能根据我目前碰到的情况进行处理。

另外：
该脚本实现了从http://i.shubao12.cc 这个网站获取小说的逻辑。传入某小说的第一章第一页，然后会一直爬取直到最后一章。
